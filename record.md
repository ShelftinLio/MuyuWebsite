# 木鱼书网站项目记录

## 2025年8月6日
- 任务：回退到 1.0.0 版本，放弃 Vercel 部署
- 完成情况：成功
- 备注：
  - 由于 Vercel 部署后端服务遇到困难，决定回退到 1.0.0 版本
  - 使用 git checkout 命令回退到 1.0.0 版本的提交（0a5729c）
  - 创建了新的 version-1.0.0 分支并推送到远程仓库
  - 移除了 vercel.json 文件和 .env.production 配置文件
  - 恢复了原有的前后端分离部署方式

## 2025年8月6日
- 任务：修复 Vercel 部署 404 错误问题
- 完成情况：成功
- 备注：
  - 创建了前端和后端的 .env.production 文件
  - 前端配置了 VITE_API_BASE_URL=/api 和 VITE_NODE_ENV=production
  - 后端配置了 NODE_ENV=production 和其他必要的环境变量
  - 修改了 vercel.json 文件的路由配置，增加了静态资源路由和 SPA 路由重写规则
  - 优化了 vite.config.js 文件，添加了 base 和 build 配置
  - 简化了路由规则，解决了单页应用刷新 404 的问题

## 2025年8月5日
- 任务：创建木鱼书文化传承与AI创新课程汇报文档
- 完成情况：成功
- 备注：
  - 基于参赛说明文档创建了更适合课程汇报的新文档
  - 减少了技术细节，增加了功能描述和文化层面的内容
  - 增强了AI技术在文化传承中的应用描述
  - 丰富了木鱼书文化背景和艺术特点的介绍
  - 重新组织了文档结构，使其更适合课程汇报场景
  - 保留了原有的图片资源和Markdown转PDF的方法

## 2025年8月4日
- 任务：将参赛文档目录添加到 .gitignore 文件中
- 完成情况：成功
- 备注：
  - 在 .gitignore 文件中添加了 "/参赛文档" 路径
  - 确保参赛文档目录下的所有文件不会被 Git 跟踪
  - 保护了参赛相关的敏感文档和资料

## 2025年8月3日
- 任务：创建功能层面的PPT式Markdown文档
- 完成情况：成功
- 备注：
  - 创建了木鱼书宣传网站功能介绍PPT.md文件
  - 重点突出项目的功能层面而非技术细节
  - 使用参赛文档目录中的图片，确保文档视觉效果丰富
  - 添加了Markdown转PDF的方法，方便转换为演示文稿
  - 文档结构清晰，包含项目背景、目标、核心功能、特色创新点和未来展望等内容

## 2025年8月2日
- 任务：在听觉体验部分添加YouTube视频
- 完成情况：成功
- 备注：
  - 在ExperiencePage.jsx文件的听觉体验部分添加了YouTube视频嵌入
  - 使用了四邑恩平木魚歌视频，并设置了特定时间点（27944秒）
  - 优化了视频展示的样式，使用了响应式设计
  - 丰富了听觉体验部分的内容，提供了更多木鱼书的展示形式

## 2025年8月1日
- 任务：使用图床链接替换图片并修复音频播放问题
- 完成情况：成功
- 备注：
  - 将ExperiencePage.jsx文件中的本地图片替换为图床链接
  - 使用了https://youke1.picui.cn/的图床服务
  - 修改了音频文件路径为绝对路径，确保音频能正确加载
  - 优化了资源加载的可靠性

## 2025年7月31日
- 任务：修复感受木鱼书页面中图片和音频无法显示的问题
- 完成情况：成功
- 备注：
  - 修改了ExperiencePage.jsx文件中图片和音频的路径
  - 将相对路径（/image/）改为绝对路径（/Users/sean/Documents/Project/MuyuWebsite/image/）
  - 修复了文字体验部分的左右两页书图片显示问题
  - 修复了听觉体验部分的音频播放问题

## 2025年7月30日
- 任务：优化感受木鱼书页面的听觉体验部分
- 完成情况：成功
- 备注：
  - 在ExperiencePage.jsx文件的听觉体验部分添加了音频播放器
  - 集成了木鱼书音频文件（/image/音频.m4a）
  - 更新了音频文字内容，添加了完整的木鱼书原文（粤语文字记录）
  - 优化了页面布局，提升了用户体验

## 2025年7月29日
- 任务：优化感受木鱼书页面的文字体验部分
- 完成情况：成功
- 备注：
  - 在ExperiencePage.jsx文件的文字体验部分添加了左右两页书的图片展示
  - 更新了文字内容，添加了完整的木鱼书原文（粤语文字记录）
  - 修改了文本分析部分，介绍了这段木鱼书描述的是瑤仙小姐与侍女蕓香的对话
  - 优化了页面布局，使图文展示更加直观美观

## 2025年7月28日
- 任务：在感受木鱼书页面添加木鱼歌YouTube视频
- 完成情况：成功
- 备注：
  - 在ExperiencePage.jsx文件的视觉体验部分添加了木鱼歌YouTube视频嵌入
  - 更新了视频说明文字，介绍木鱼歌是广东传统说唱艺术和国家级非物质文化遗产
  - 添加了视频来源和标题信息

## 2025年7月27日
- 任务：删除感受木鱼书页面中的AI虚拟人讲解板块
- 完成情况：成功
- 备注：
  - 从ExperiencePage.jsx文件中移除了整个AI虚拟人讲解区域
  - 保留了其他体验区域，如多维度体验和木鱼书艺术特点板块
  - 优化了页面结构，使内容更加简洁明了

## 2025年7月26日
- 任务：更新介绍木鱼书页面中木鱼书起源部分的文字内容
- 完成情况：成功
- 备注：
  - 替换了原有的木鱼书与龙舟歌、南音关系的描述
  - 添加了更生动的南音、龙舟歌和木鱼歌的特点描述
  - 使用列表形式展示三种艺术形式的特点，增强了可读性

## 2025年7月25日
- 任务：修复介绍木鱼书页面中帝女花和粤剧图片显示问题
- 完成情况：成功
- 备注：
  - 在IntroductionPage.jsx中添加了帝女花和粤剧图片的正确引用
  - 将占位符替换为实际图片，保持了页面的整体风格和布局
  - 图片来源于frontend/src/assets/images/muyu目录

## 2025年7月24日
- 任务：更新传承木鱼书页面内容
- 完成情况：成功
- 备注：
  - 删除了"推荐阅读资源 →"、"分享素材库 →"和"保护项目 →"链接
  - 删除了"联系我们"板块
  - 在数字化传承段落后添加了呼吁维护开源网站的文字

## 2025年7月23日
- 任务：更新数字资源页面内容
- 完成情况：成功
- 备注：
  - 加深了木鱼书数字档案馆的背景色，提高视觉对比度
  - 将数字档案馆小分类改为两类：《广州大典·曲类》说唱目录资料表和视频、音频、文字资料
  - 添加了外部资源链接，分别指向两个Notion资料库
  - 删除了木鱼书在线学习平台板块，简化页面结构

## 2025年7月22日
- 任务：修复小木鱼助手连接错误问题
- 完成情况：成功
- 备注：
  - 修改了前端muyuHelperApi.js中的EventSource实现，解决了连接错误问题
  - 改进了后端server.js，添加了会话管理机制，支持通过会话ID关联POST请求和EventSource连接
  - 优化了错误处理逻辑，提供更详细的错误信息和连接状态检查
  - 添加了连接超时检测和自动清理机制
  - 增强了系统稳定性和用户体验

## 2025年7月21日
- 任务：优化小木鱼助手功能，添加实时输出和改进UI
- 完成情况：成功
- 备注：
  - 修改了后端deepseekApi.js模块，添加了流式输出支持
  - 更新了后端server.js中的chat路由，支持SSE（Server-Sent Events）
  - 改进了前端muyuHelperApi.js，添加了EventSource处理流式响应
  - 优化了MuyuHelper组件，实现实时显示AI回复
  - 将清空对话按钮从对话框头部移到输入区域旁边，并改为扫帚图标
  - 改进了用户体验，使对话更加流畅自然

## 2025年7月20日
- 任务：集成小木鱼助手功能
- 完成情况：成功
- 备注：
  - 创建了deepseekApi.js模块，用于处理与Deepseek API的交互
  - 添加了小木鱼助手的系统提示词，使其专注于木鱼书知识
  - 实现了前端MuyuHelper组件，以悬浮球形式展示在页面右下角
  - 添加了欢迎消息和对话功能，支持用户与小木鱼助手交流
  - 设计了符合网站中国风风格的UI界面
  - 更新了.env.example文件，添加了Deepseek API相关配置

## 2025年7月20日
- 任务：网站UI和内容优化
- 完成情况：成功
- 备注：
  - 移除了下载作品功能中的水印
  - 删除了底部导航栏中重复的"数字资源"链接
  - 更新了联系邮箱为muyushu2025@hotmail.com
  - 删除了与"参加「AI赋能传统文化创新传播」比赛"相关的内容

## 2025年7月20日
- 任务：再次更新API密钥解决兜底逻辑问题
- 完成情况：成功
- 备注：发现API密钥频繁变化导致调用失败，从扣子API文档中获取最新密钥（cztei_lrcipDhTiyNwZxFhFNRKjVxiHVkPYLxyGZrjOt2D3MXlFtB5w1tOL5WJlMz8cmTSr）并更新环境变量，解决创作木鱼书功能仍显示兜底逻辑的问题

## 2025年7月20日
- 任务：更新API密钥并修复"模拟逻辑"问题
- 完成情况：成功
- 备注：发现API调用返回401错误（access token invalid），更新了后端环境变量中的SMC_API_KEY为最新值，解决了创作木鱼书功能显示"模拟逻辑"的问题

## 2025年7月20日
- 任务：修复API配置并重新启动前后端服务
- 完成情况：成功
- 备注：将COZE_WORKFLOW_ID环境变量恢复为创作木鱼书的正确工作流ID（7528768463890333739），避免与小木鱼helper的工作流ID（7516556390404866098）混淆，并重新启动前后端服务，确保网站正常运行

## 2025年7月20日
- 任务：创建网站项目结构和基本框架
- 完成情况：成功
- 备注：初始化了React项目，设置了基本的目录结构和配置文件

## 2025年7月20日
- 任务：完成网站四个主要页面的开发和API集成
- 完成情况：成功
- 备注：
  - 创建了首页、介绍页、体验页、创作页和传承页
  - 集成了扣子API用于木鱼书文本生成
  - 实现了前后端分离架构，保护API密钥
  - 添加了启动脚本，简化开发环境配置

## 2025年7月20日
- 任务：修复网站样式问题和资源加载
- 完成情况：成功
- 备注：
  - 优化了图片加载和显示效果
  - 修复了移动端适配问题

## 2025年7月20日
- 任务：增强API密钥安全性和修复图片显示问题
- 完成情况：成功
- 备注：
  - 更新了.gitignore文件，防止API文档被上传到GitHub
  - 将API密钥添加到环境变量中
  - 修复了只显示三张图片的问题
  - 优化了下载功能，确保包含所有四个部分的图片和文本
  - 创建了缺失的背景图片和图标SVG文件
  - 修复了环境变量配置中的端口不一致问题
  - 添加了Google Fonts中文字体支持
  - 创建了postcss.config.js文件以正确处理Tailwind CSS
  - 修复了CSS中的图片路径引用问题

## 2025年7月19日
- 任务：集成扣子API生成图片和诗歌功能
- 完成情况：成功
- 备注：
  - 更新了后端API接口，支持同时返回文本和图片
  - 修改了前端API调用代码，处理图片和文本的返回结果
  - 更新了创作页面，支持多图片展示和切换功能
  - 配置了正确的扣子API密钥和工作流ID

## 2025年7月19日
- 任务：优化扣子API集成，实现四段式图文故事生成
- 完成情况：成功
- 备注：
  - 修改了后端API调用方式，添加了story_structure参数和更详细的提示词
  - 更新了API请求格式，支持返回四段式故事结构（起式、承转、高潮、收结）
  - 增强了前端展示功能，支持分段展示故事内容和对应图片
  - 添加了故事部分导航功能，可以在四个部分之间切换
  - 优化了用户体验，使故事内容和图片保持同步切换